# Forgot Password E2E Tests
# Tests the password reset request flow

appId: host.exp.Exponent

env:
  TEST_USER_EMAIL: "test@nutri-e2e.local"

---

# Test: Submit Forgot Password Request
- runFlow: ../../flows/launch_app.yaml

# Navigate to forgot password
- tapOn:
    text: "Sign In"
- assertVisible:
    id: "signin-screen"
- tapOn:
    id: "signin-forgot-password-link"

# Verify forgot password screen
- assertVisible:
    id: "forgot-password-screen"

# Enter email
- tapOn:
    id: "forgot-password-email-input"
- inputText: ${TEST_USER_EMAIL}

# Submit request
- tapOn:
    id: "forgot-password-submit-button"

# Should show success screen
- extendedWaitUntil:
    visible:
      id: "forgot-password-success-screen"
    timeout: 15000

---

# Test: Empty Email Validation
- runFlow: ../../flows/launch_app.yaml

- tapOn:
    text: "Sign In"
- tapOn:
    id: "signin-forgot-password-link"
- assertVisible:
    id: "forgot-password-screen"

# Try to submit without email
- tapOn:
    id: "forgot-password-submit-button"

# Should stay on forgot password screen
- assertVisible:
    id: "forgot-password-screen"

---

# Test: Invalid Email Format
- runFlow: ../../flows/launch_app.yaml

- tapOn:
    text: "Sign In"
- tapOn:
    id: "signin-forgot-password-link"
- assertVisible:
    id: "forgot-password-screen"

# Enter invalid email
- tapOn:
    id: "forgot-password-email-input"
- inputText: "not-an-email"

- tapOn:
    id: "forgot-password-submit-button"

# Should stay on forgot password screen
- assertVisible:
    id: "forgot-password-screen"

---

# Test: Back to Sign In from Forgot Password
- runFlow: ../../flows/launch_app.yaml

- tapOn:
    text: "Sign In"
- tapOn:
    id: "signin-forgot-password-link"
- assertVisible:
    id: "forgot-password-screen"

# Tap sign in link
- tapOn:
    id: "forgot-password-signin-link"

# Should navigate to sign in screen
- assertVisible:
    id: "signin-screen"
