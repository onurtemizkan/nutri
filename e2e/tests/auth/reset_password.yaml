# Reset Password E2E Tests
# Tests the password reset flow with token

appId: host.exp.Exponent

---

# Test: Reset Password Token Screen Navigation
- launchApp:
    clearState: true

# Navigate to reset password screen directly (simulates deep link without token)
# First we need to go through forgot password flow
- assertVisible:
    id: "welcome-screen"
- tapOn:
    id: "welcome-signin-button"
- tapOn:
    id: "signin-forgot-password-link"
- assertVisible:
    id: "forgot-password-screen"

# Submit email to get token
- tapOn:
    id: "forgot-password-email-input"
- inputText: ${TEST_USER_EMAIL}
- tapOn:
    id: "forgot-password-submit-button"

# Note: In a real test, we would capture the token from the dev alert
# For now, verify the success screen is shown
- assertVisible:
    id: "forgot-password-success-screen"

---

# Test: Reset Password Validation - Empty Fields
- launchApp:
    clearState: true
    arguments:
      resetToken: "test-token-123"

# If app started with token param, should show password form
# Otherwise, will show token entry screen
- assertVisible:
    id: "reset-password-screen"

# Try to submit without passwords
- tapOn:
    id: "reset-password-submit-button"

# Should stay on reset password screen
- assertVisible:
    id: "reset-password-screen"

---

# Test: Reset Password Validation - Password Mismatch
- launchApp:
    clearState: true
    arguments:
      resetToken: "test-token-123"

- assertVisible:
    id: "reset-password-screen"

# Enter mismatched passwords
- tapOn:
    id: "reset-password-new-password-input"
- inputText: "newPassword123"

- tapOn:
    id: "reset-password-confirm-password-input"
- inputText: "differentPassword123"

- tapOn:
    id: "reset-password-submit-button"

# Should stay on reset password screen
- assertVisible:
    id: "reset-password-screen"

---

# Test: Reset Password Validation - Short Password
- launchApp:
    clearState: true
    arguments:
      resetToken: "test-token-123"

- assertVisible:
    id: "reset-password-screen"

# Enter short password
- tapOn:
    id: "reset-password-new-password-input"
- inputText: "ab1"

- tapOn:
    id: "reset-password-confirm-password-input"
- inputText: "ab1"

- tapOn:
    id: "reset-password-submit-button"

# Should stay on reset password screen
- assertVisible:
    id: "reset-password-screen"

---

# Test: Navigation to Sign In from Reset Password
- launchApp:
    clearState: true
    arguments:
      resetToken: "test-token-123"

- assertVisible:
    id: "reset-password-screen"

# Tap sign in link
- tapOn:
    id: "reset-password-signin-link"

# Should navigate to sign in
- assertVisible:
    id: "signin-screen"
