# Comprehensive Password Reset E2E Tests
# Tests forgot password and reset flows

appId: host.exp.Exponent

---

# Test: Forgot Password - Request Reset for Valid Email
- runFlow: ../../flows/launch_app.yaml

- tapOn:
    text: "Sign In"

- assertVisible:
    id: "signin-screen"

- tapOn:
    id: "signin-forgot-password-link"

- assertVisible:
    id: "forgot-password-screen"

# Enter valid email
- tapOn:
    id: "forgot-password-email-input"
- inputText: ${TEST_USER_EMAIL}

- tapOn:
    id: "forgot-password-submit-button"

# Should show success message or navigate
- assertVisible:
    text: "email"
    optional: true

---

# Test: Forgot Password - Invalid Email Format
- runFlow: ../../flows/launch_app.yaml

- tapOn:
    text: "Sign In"

- assertVisible:
    id: "signin-screen"

- tapOn:
    id: "signin-forgot-password-link"

- assertVisible:
    id: "forgot-password-screen"

# Enter invalid email
- tapOn:
    id: "forgot-password-email-input"
- inputText: ${INVALID_EMAIL}

- tapOn:
    id: "forgot-password-submit-button"

# Should stay on screen (validation error)
- assertVisible:
    id: "forgot-password-screen"

---

# Test: Forgot Password - Empty Email Validation
- runFlow: ../../flows/launch_app.yaml

- tapOn:
    text: "Sign In"

- assertVisible:
    id: "signin-screen"

- tapOn:
    id: "signin-forgot-password-link"

- assertVisible:
    id: "forgot-password-screen"

# Submit without entering email
- tapOn:
    id: "forgot-password-submit-button"

# Should stay on screen
- assertVisible:
    id: "forgot-password-screen"

---

# Test: Forgot Password - Non-existent Email (Silent Fail)
- runFlow: ../../flows/launch_app.yaml

- tapOn:
    text: "Sign In"

- assertVisible:
    id: "signin-screen"

- tapOn:
    id: "signin-forgot-password-link"

- assertVisible:
    id: "forgot-password-screen"

# Enter non-existent email (should still show success for security)
- tapOn:
    id: "forgot-password-email-input"
- inputText: ${NONEXISTENT_EMAIL}

- tapOn:
    id: "forgot-password-submit-button"

# Should show success message (security: don't reveal if email exists)
- assertVisible:
    text: "email"
    optional: true

---

# Test: Navigate Back from Forgot Password
- runFlow: ../../flows/launch_app.yaml

- tapOn:
    text: "Sign In"

- assertVisible:
    id: "signin-screen"

- tapOn:
    id: "signin-forgot-password-link"

- assertVisible:
    id: "forgot-password-screen"

# Go back
- tapOn:
    id: "forgot-password-back-button"

# Should be back on sign in
- assertVisible:
    id: "signin-screen"
