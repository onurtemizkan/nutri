appId: ${APP_ID}

---
# Test: Auth Guard - Redirect to Welcome When Not Authenticated
# Description: Validates unauthenticated users are redirected to welcome screen

- launchApp

# Should land on welcome screen (not authenticated)
- assertVisible: "Nutri"
- assertVisible: "Sign In"
- assertVisible: "Create Account"

# Should not see authenticated content
- assertNotVisible: "Hello"
- assertNotVisible: "Calories"
- assertNotVisible: "Home"
- assertNotVisible: "Profile"

---
# Test: Auth Guard - Redirect to Home After Login
# Description: Validates authenticated users are redirected to home screen

- launchApp

# Start at welcome
- assertVisible: "Nutri"

# Login
- tapOn: "Sign In"
- tapOn:
    text: "your@email.com"
- inputText: "${TEST_EMAIL}"
- tapOn:
    text: "Enter your password"
- inputText: "${TEST_PASSWORD}"
- tapOn: "Sign In"

# Should auto-redirect to Home
- assertVisible: "Hello, ${TEST_NAME}!"
- assertVisible: "Home"
- assertVisible: "Profile"

# Should not see auth screens
- assertNotVisible: "Sign In"
- assertNotVisible: "Create Account"

---
# Test: Auth Guard - Redirect to Welcome After Logout
# Description: Validates users are redirected to welcome after logout

- launchApp

# Login
- tapOn: "Sign In"
- tapOn:
    text: "your@email.com"
- inputText: "${TEST_EMAIL}"
- tapOn:
    text: "Enter your password"
- inputText: "${TEST_PASSWORD}"
- tapOn: "Sign In"

# Verify authenticated
- assertVisible: "Hello, ${TEST_NAME}!"

# Logout
- tapOn: "Profile"
- scroll  # Find logout button
- tapOn: "Logout"
- tapOn: "Logout"  # Confirm

# Should auto-redirect to welcome
- assertVisible: "Nutri"
- assertVisible: "Sign In"
- assertVisible: "Create Account"

# Should not see authenticated content
- assertNotVisible: "Hello"
- assertNotVisible: "Home"
- assertNotVisible: "Profile"

---
# Test: Auth Guard - Cannot Access Tabs When Not Authenticated
# Description: Validates protected routes are inaccessible without auth

- launchApp

# Should start at welcome
- assertVisible: "Nutri"
- assertVisible: "Sign In"

# Tab bar should not be visible
- assertNotVisible: "Home"
- assertNotVisible: "Profile"

# Cannot navigate to protected screens (they don't exist in nav)
- assertNotVisible: "Calories"
- assertNotVisible: "Daily Goals"

---
# Test: Auth Guard - Session Persistence After App Relaunch
# Description: Validates auth state persists across app launches

- launchApp

# Login
- tapOn: "Sign In"
- tapOn:
    text: "your@email.com"
- inputText: "${TEST_EMAIL}"
- tapOn:
    text: "Enter your password"
- inputText: "${TEST_PASSWORD}"
- tapOn: "Sign In"

# Verify authenticated
- assertVisible: "Hello, ${TEST_NAME}!"

# Stop and relaunch app
- stopApp
- launchApp

# Should still be authenticated (token persisted)
- assertVisible: "Hello, ${TEST_NAME}!"
- assertVisible: "Home"
- assertVisible: "Profile"

# Should not see welcome screen
- assertNotVisible: "Sign In"
- assertNotVisible: "Create Account"
