appId: ${APP_ID}

---
# Test: Add Meal Complete Flow
# Description: Validates adding a meal with all required fields

# Prerequisites: User must be logged in
- launchApp

# Login
- tapOn: "Sign In"
- tapOn:
    text: "your@email.com"
- inputText: "${TEST_EMAIL}"
- tapOn:
    text: "Enter your password"
- inputText: "${TEST_PASSWORD}"
- tapOn: "Sign In"

# Wait for home screen
- assertVisible: "Hello, ${TEST_NAME}!"

# Open add meal modal (look for + button or "Add Meal" button)
- tapOn: "Add Meal"

# Verify modal opened
- assertVisible: "Add Meal"
- assertVisible: "Meal Type"

# Select meal type - Lunch (default)
- tapOn: "Lunch"

# Fill in meal name
- tapOn:
    text: "e.g., Grilled Chicken Salad"
- inputText: "${TEST_MEAL_NAME}"

# Fill in nutrition information
- tapOn:
    text: "Calories"
- inputText: "${TEST_MEAL_CALORIES}"

- tapOn:
    text: "Protein"
- inputText: "${TEST_MEAL_PROTEIN}"

- tapOn:
    text: "Carbs"
- inputText: "${TEST_MEAL_CARBS}"

- tapOn:
    text: "Fat"
- inputText: "${TEST_MEAL_FAT}"

# Save meal
- tapOn: "Save"

# Verify success message
- assertVisible: "Meal added successfully"

# Verify back on home screen
- tapOn: "OK"
- assertVisible: "Hello, ${TEST_NAME}!"
- assertVisible: "${TEST_MEAL_CALORIES}"

---
# Test: Add Meal - Select Breakfast
# Description: Validates selecting breakfast meal type

- launchApp

# Login
- tapOn: "Sign In"
- tapOn:
    text: "your@email.com"
- inputText: "${TEST_EMAIL}"
- tapOn:
    text: "Enter your password"
- inputText: "${TEST_PASSWORD}"
- tapOn: "Sign In"

# Open add meal
- tapOn: "Add Meal"

# Select breakfast
- tapOn: "Breakfast"

# Fill minimal required fields
- tapOn:
    text: "e.g., Grilled Chicken Salad"
- inputText: "Oatmeal"

- tapOn:
    text: "Calories"
- inputText: "300"

- tapOn:
    text: "Protein"
- inputText: "10"

- tapOn:
    text: "Carbs"
- inputText: "55"

- tapOn:
    text: "Fat"
- inputText: "6"

# Save
- tapOn: "Save"
- assertVisible: "Meal added successfully"
- tapOn: "OK"

---
# Test: Add Meal - Select Dinner
# Description: Validates selecting dinner meal type

- launchApp

# Login
- tapOn: "Sign In"
- tapOn:
    text: "your@email.com"
- inputText: "${TEST_EMAIL}"
- tapOn:
    text: "Enter your password"
- inputText: "${TEST_PASSWORD}"
- tapOn: "Sign In"

# Open add meal
- tapOn: "Add Meal"

# Select dinner
- tapOn: "Dinner"

# Fill required fields
- tapOn:
    text: "e.g., Grilled Chicken Salad"
- inputText: "Salmon with Vegetables"

- tapOn:
    text: "Calories"
- inputText: "550"

- tapOn:
    text: "Protein"
- inputText: "40"

- tapOn:
    text: "Carbs"
- inputText: "30"

- tapOn:
    text: "Fat"
- inputText: "25"

# Save
- tapOn: "Save"
- assertVisible: "Meal added successfully"

---
# Test: Add Meal - Select Snack
# Description: Validates selecting snack meal type

- launchApp

# Login
- tapOn: "Sign In"
- tapOn:
    text: "your@email.com"
- inputText: "${TEST_EMAIL}"
- tapOn:
    text: "Enter your password"
- inputText: "${TEST_PASSWORD}"
- tapOn: "Sign In"

# Open add meal
- tapOn: "Add Meal"

# Select snack
- tapOn: "Snack"

# Fill required fields
- tapOn:
    text: "e.g., Grilled Chicken Salad"
- inputText: "Protein Bar"

- tapOn:
    text: "Calories"
- inputText: "200"

- tapOn:
    text: "Protein"
- inputText: "20"

- tapOn:
    text: "Carbs"
- inputText: "15"

- tapOn:
    text: "Fat"
- inputText: "8"

# Save
- tapOn: "Save"
- assertVisible: "Meal added successfully"

---
# Test: Add Meal - Cancel
# Description: Validates canceling meal creation

- launchApp

# Login
- tapOn: "Sign In"
- tapOn:
    text: "your@email.com"
- inputText: "${TEST_EMAIL}"
- tapOn:
    text: "Enter your password"
- inputText: "${TEST_PASSWORD}"
- tapOn: "Sign In"

# Open add meal
- tapOn: "Add Meal"

# Fill some fields
- tapOn:
    text: "e.g., Grilled Chicken Salad"
- inputText: "Test Meal"

# Cancel
- tapOn: "Cancel"

# Verify back on home screen without adding meal
- assertVisible: "Hello, ${TEST_NAME}!"

---
# Test: Add Meal Validation - Missing Fields
# Description: Validates required field validation

- launchApp

# Login
- tapOn: "Sign In"
- tapOn:
    text: "your@email.com"
- inputText: "${TEST_EMAIL}"
- tapOn:
    text: "Enter your password"
- inputText: "${TEST_PASSWORD}"
- tapOn: "Sign In"

# Open add meal
- tapOn: "Add Meal"

# Only fill meal name
- tapOn:
    text: "e.g., Grilled Chicken Salad"
- inputText: "Incomplete Meal"

# Try to save
- tapOn: "Save"

# Verify error message
- assertVisible: "Please fill in all required fields"

---
# Test: Add Meal with Optional Fields
# Description: Validates adding meal with fiber, serving size, and notes

- launchApp

# Login
- tapOn: "Sign In"
- tapOn:
    text: "your@email.com"
- inputText: "${TEST_EMAIL}"
- tapOn:
    text: "Enter your password"
- inputText: "${TEST_PASSWORD}"
- tapOn: "Sign In"

# Open add meal
- tapOn: "Add Meal"

# Fill required fields
- tapOn: "Lunch"
- tapOn:
    text: "e.g., Grilled Chicken Salad"
- inputText: "Quinoa Bowl"

- tapOn:
    text: "Calories"
- inputText: "400"

- tapOn:
    text: "Protein"
- inputText: "15"

- tapOn:
    text: "Carbs"
- inputText: "60"

- tapOn:
    text: "Fat"
- inputText: "10"

# Scroll to see optional fields
- scroll

# Fill optional fields
- tapOn:
    text: "Fiber"
- inputText: "8"

- tapOn:
    text: "Serving Size"
- inputText: "1 cup"

- tapOn:
    text: "Notes"
- inputText: "Healthy lunch option"

# Save
- tapOn: "Save"
- assertVisible: "Meal added successfully"
