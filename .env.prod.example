# =============================================================================
# Nutri Production Environment Variables
# =============================================================================
#
# Instructions:
#   1. Copy this file to .env.prod: cp .env.prod.example .env.prod
#   2. Fill in all REQUIRED values (marked with [REQUIRED])
#   3. Run: docker-compose -f docker-compose.prod.yml --env-file .env.prod up
#
# For Coolify/Hetzner deployment:
#   - Set these as environment variables in the Coolify dashboard
#   - Database URL will point to Supabase (external)
#   - Redis URL will point to Upstash (external)
#
# =============================================================================

# =============================================================================
# PostgreSQL Database [REQUIRED]
# =============================================================================
# For local Docker testing (uses local postgres container):
DATABASE_URL=postgresql://postgres:your-secure-password@postgres:5432/nutri_db

# For Supabase (production):
# DATABASE_URL=postgresql://postgres.[your-project-ref]:[your-password]@aws-0-[region].pooler.supabase.com:6543/postgres

# ML Service database URL (uses async driver)
# For local Docker testing:
ML_DATABASE_URL=postgresql+asyncpg://postgres:your-secure-password@postgres:5432/nutri_db

# For Supabase (production):
# ML_DATABASE_URL=postgresql+asyncpg://postgres.[your-project-ref]:[your-password]@aws-0-[region].pooler.supabase.com:6543/postgres

# PostgreSQL container credentials (only for local Docker)
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-secure-password
POSTGRES_DB=nutri_db

# =============================================================================
# Redis Cache
# =============================================================================
# For local Docker testing (uses local redis container):
REDIS_URL=redis://redis:6379/0

# For Upstash (production):
# REDIS_URL=rediss://default:[your-password]@[your-endpoint].upstash.io:6379

# =============================================================================
# JWT Authentication [REQUIRED]
# =============================================================================
# SECURITY WARNING: Generate a strong secret key for production!
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# NEVER commit real secrets to version control!
JWT_SECRET=your-256-bit-secret-key-CHANGE-THIS-IN-PRODUCTION

# Token expiration (default: 7 days)
JWT_EXPIRES_IN=7d

# =============================================================================
# Environment Settings
# =============================================================================
NODE_ENV=production

# =============================================================================
# Optional: Monitoring & Error Tracking
# =============================================================================
# Sentry DSN for error tracking
# SENTRY_DSN=https://xxxxx@xxxxx.ingest.sentry.io/xxxxx

# =============================================================================
# Optional: CORS Configuration
# =============================================================================
# Comma-separated list of allowed origins
# CORS_ORIGIN=https://your-mobile-app-domain.com

# =============================================================================
# Deployment Notes for Coolify + Hetzner
# =============================================================================
#
# When deploying to Coolify on Hetzner CX32:
#
# 1. Database (Supabase Free):
#    - Create project at https://supabase.com
#    - Use Supabase connection pooler URL for DATABASE_URL
#    - Use ?pgbouncer=true for connection pooling
#
# 2. Redis (Upstash Free):
#    - Create database at https://upstash.com
#    - Use the Redis REST URL or standard URL
#    - Enable TLS (use rediss:// protocol)
#
# 3. JWT Secret:
#    - Generate a secure 256-bit key
#    - Store in Coolify environment variables (marked as secret)
#
# 4. Health Checks:
#    - Backend: GET /health
#    - ML Service: GET /health (internal only)
#
# 5. Resource Limits (for CX32 with 4GB RAM):
#    - Backend: ~512MB
#    - ML Service: ~1GB
#    - Redis: 256MB (handled by Upstash)
#    - PostgreSQL: (handled by Supabase)
#
